The technology of the distributed ledger, the so-called blockchain, is expanding beyond the creation of efficiencies in financial intermediation to include the management of consumption data originating from iot micro devices, the trading of surplus renewable energy, and programmable transactions in the form of so-called smart contracts. Although the majority of current applications involve payments of some form, the key question going forward is whether the two technologies which underpin bitcoin, namely a digital token and the blockchain, can serve as a basis for other use cases. In this paper we examine the evolution and design of marketplaces for digital economies. We first introduce a simple economic model which we use to understand the dynamics of firm boundaries, and the organisation of economic activity more generally. In examining how the contrasting forces of scale and scope economies, together with the relative costs of transacting within firms and markets have facilitated the emergence of decentralised marketplaces, we make use of a number of core economic principles. These include the economics of transaction costs, ownership and control, the principal-agent problem, bounded rationality, information asymmetry and trust relations. We also consider the technological antecedents of blockchain technology, including the Internet protocols and the fundamental distinction between a distributed database and ledger. Against this backdrop we consider the motivation behind the fetch protocol which provides a set of tools for the dynamic creation of intelligent marketplaces for an agent-based economy. jel Classification Code: D21, D25, D43, D47, D83, L14. Keywords: blockchain; distributed ledger; smart contracts; mechanism design; theory of the firm; digital economies, autonomous agents; fetch. 